<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Bhajan</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #ff6b6b;
            --dark: #333;
            --light: #f8f9fa;
            --success: #51cf66;
            --warning: #fcc419;
            --muted: #adb5bd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 10px;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .subtitle {
            color: var(--muted);
            font-size: 14px;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }
        
        .cover-art {
            width: 180px;
            height: 180px;
            border-radius: 12px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        .cover-art img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cover-art .icon {
            font-size: 48px;
            color: var(--muted);
            opacity: 0.7;
        }
        
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .btn {
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn-primary {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(74, 111, 165, 0.3);
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
        }
        
        .btn-secondary {
            color: var(--primary);
            font-size: 20px;
            opacity: 0.8;
        }
        
        .btn-secondary:hover {
            opacity: 1;
        }
        
        .progress-container {
            width: 100%;
            height: 4px;
            background-color: #e9ecef;
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary);
            width: 0%;
            border-radius: 2px;
            transition: width 0.1s linear;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .option {
            padding: 14px 20px;
            border-radius: 12px;
            background-color: white;
            border: 1px solid #e9ecef;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .option.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .option.wrong {
            background-color: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .option-prefix {
            font-weight: bold;
            margin-right: 10px;
            min-width: 20px;
        }
        
        .next-btn {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            background-color: var(--primary);
            color: white;
            border: none;
            font-weight: 600;
            margin-top: 15px;
            cursor: pointer;
            display: none;
        }
        
        .next-btn:hover {
            opacity: 0.9;
        }
        
        .game-over {
            text-align: center;
            display: none;
        }
        
        .game-over h2 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .restart-btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            background-color: var(--primary);
            color: white;
            border: none;
            font-weight: 600;
            margin-top: 20px;
            cursor: pointer;
        }

        .round-counter {
            text-align: center;
            color: var(--muted);
            font-size: 14px;
            margin-bottom: 10px;
        }

        /* Intro card styles */
        .intro-card {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease-out;
        }
        
        .intro-title {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 400px) {
            .cover-art {
                width: 160px;
                height: 160px;
            }
            
            .intro-title {
                font-size: 2rem;
            }
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas>
    
    <!-- Intro Card -->
    <div class="intro-card" id="intro-card">
        <h1 class="intro-title">Guess the Bhajan</h1>
    </div>

    <div class="container">
        <header>
            <h1>Guess the Bhajan</h1>
            <div class="subtitle">Listen to the instrumental and guess the bhajan</div>
            <div class="round-counter" id="round-counter">Round 1</div>
        </header>
        
        <div id="game-screen" style="display: none;">
            <div class="card">
                <div class="cover-art" id="cover-art">
                    <img src="https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Thumbnail/Whatsapp DP.jpg" alt="Bhajan Cover">
                </div>
                
                <div class="player-controls">
                    <button class="btn btn-secondary" id="prev-btn">↻</button>
                    <button class="btn btn-primary" id="play-btn">▶</button>
                    <button class="btn btn-secondary" id="next-btn">⏭</button>
                </div>
                
                <div class="progress-container" id="progress-container">
                    <div class="progress" id="progress"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="options" id="options-container">
                    <!-- Options will be inserted here by JavaScript -->
                </div>
                
                <button class="next-btn" id="next-round-btn">Next Bhajan</button>
            </div>
        </div>
        
        <div id="game-over-screen" class="game-over">
            <h2>Game Over!</h2>
            <p>Thanks for playing Guess the Bhajan!</p>
            <button class="restart-btn" id="restart-btn">Play Again</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
        // Bhajan database with more Gujarati bhajans
        const bhajans = [
  {
    title: "Hal Tane Hal Saurashtra Batavu",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Hal Tane Hal Saurashtra Batavu.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Hal Tane Hal Saurashtra Batavu.mp3"
  },
  {
    title: "Hari Tu Gadu Maru Kya Lai Jay",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Hari Tu Gadu Maru Kya Lai Jay.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Hari Tu Gadu Maru Kya Lai Jay.mp3"
  },
  {
    title: "Helo Maro Sambhlo Ranuja",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Helo Maro Sambhlo Ranuja.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Helo Maro Sambhlo Ranuja.mp3"
  },
  {
    title: "Jagma Motu Nam Che Jogi Jalaram Che",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Jagma Motu Nam Che Jogi Jalaram Che.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Jagma Motu Nam Che Jogi Jalaram Che.mp3"
  },
  {
    title: "Jiv Shane Fare Chhe Guman Ma",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Jiv Shane Fare Chhe Guman Ma.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Jiv Shane Fare Chhe Guman Ma.mp3"
  },
  {
    title: "Karmano Sangathi Rana Maru Koi Nathi",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Karmano Sangathi Rana Maru Koi Nathi.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/Karmano Sangathi Rana Maru Koi Nathi.mp3"
  },
  {
    title: "Tu Rangai Jane Rang Ma",
    instrumental: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Instrument/Tu rangai jane ne rang ma.mp3",
    vocal: "https://raw.githubusercontent.com/rohitratilal/Guess-the-Bhajan/main/Vocal/TU RANGAI JANE RANG MA.mp3"
  }
];


        // Additional Gujarati bhajans for options
        const gujaratiBhajans = [
            "Hal Tane Hal Saurashtra Batavu",
            "Jai Jalaram Jai Jalaram",
            "Aavo Padharo Mhare Des",
            "Tara Vina Shyam Na Aave",
            "Mor Bani Thangat Kare",
            "Vaishnav Jan To",
            "Prabhu Ji Tum Chandan Hum Pani",
            "Mane Makan Ni Murti",
            "Ame Bhagat Tari Re",
            "Shiv Shankar Mahadev",
            "Bolo Jai Jai Ram Krishna Hari",
            "Krishna Vandana",
            "Jay Jay Santoshi Mata",
            "Jai Ambe Gauri",
            "Shri Ram Chandra Kripalu Bhajman",
            "Shri Krishna Govind Hare Murari",
            "Radhe Radhe Barsane Wali Radhe",
            "Jai Ganesh Deva",
            "Om Jai Jagdish Hare",
            "Shyam Teri Bansi Pukare"
        ];

        // Game variables
        let currentBhajanIndex;
        let audio;
        let vocalAudio;
        let isPlaying = false;
        let gameOver = false;
        let usedBhajanIndices = [];
        let currentRound = 1;
        let canSelectAnswer = false;
        let correctAnswerSelected = false;

        // DOM elements
        const playBtn = document.getElementById('play-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressContainer = document.getElementById('progress-container');
        const progress = document.getElementById('progress');
        const coverArt = document.getElementById('cover-art');
        const optionsContainer = document.getElementById('options-container');
        const nextRoundBtn = document.getElementById('next-round-btn');
        const gameScreen = document.getElementById('game-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const restartBtn = document.getElementById('restart-btn');
        const introCard = document.getElementById('intro-card');
        const roundCounter = document.getElementById('round-counter');

        // Show intro card and then fade it out
        function showIntro() {
            setTimeout(() => {
                introCard.style.opacity = '0';
                setTimeout(() => {
                    introCard.style.display = 'none';
                    gameScreen.style.display = 'block';
                    initGame();
                }, 1000);
            }, 2000); // Show intro for 2 seconds before fading
        }

        // Initialize game
        function initGame() {
            gameOver = false;
            usedBhajanIndices = [];
            currentRound = 1;
            updateRoundCounter();
            gameScreen.style.display = 'block';
            gameOverScreen.style.display = 'none';
            loadNewBhajan();
        }

        // Update round counter display
        function updateRoundCounter() {
            roundCounter.textContent = `Round ${currentRound}`;
        }

        // Load a new bhajan for guessing
        function loadNewBhajan() {
            // Reset state
            canSelectAnswer = false;
            correctAnswerSelected = false;
            nextRoundBtn.style.display = 'none';
            
            // Find a bhajan that hasn't been used yet
            let availableBhajans = bhajans.filter((_, index) => !usedBhajanIndices.includes(index));
            
            if (availableBhajans.length === 0) {
                // If all bhajans have been used, reset (for unlimited play)
                usedBhajanIndices = [];
                availableBhajans = bhajans;
            }
            
            // Select random bhajan
            currentBhajanIndex = Math.floor(Math.random() * availableBhajans.length);
            const currentBhajan = availableBhajans[currentBhajanIndex];
            
            // Add to used indices (using original index)
            const originalIndex = bhajans.findIndex(b => b.title === currentBhajan.title);
            usedBhajanIndices.push(originalIndex);
            
            // Set up audio
            if (audio) {
                audio.pause();
                audio.currentTime = 0;
            }
            
            audio = new Audio(currentBhajan.instrumental);
            
            // Set up audio event listeners
            audio.addEventListener('timeupdate', updateProgress);
            audio.addEventListener('ended', () => {
                isPlaying = false;
                playBtn.textContent = '▶';
                canSelectAnswer = true; // Allow answer selection only after song ends
            });
            
            // Reset play button
            isPlaying = false;
            playBtn.textContent = '▶';
            
            // Generate options (1 correct + 3 random incorrect)
            const options = [currentBhajan.title];
            
            // Get random incorrect options from the larger Gujarati bhajans list
            const incorrectOptions = gujaratiBhajans
                .filter(title => title !== currentBhajan.title)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3);
            
            options.push(...incorrectOptions);
            
            // Shuffle options
            options.sort(() => Math.random() - 0.5);
            
            // Display options with A, B, C, D prefixes
            optionsContainer.innerHTML = '';
            const prefixes = ['A', 'B', 'C', 'D'];
            options.forEach((option, index) => {
                const button = document.createElement('div');
                button.className = 'option';
                
                const prefixSpan = document.createElement('span');
                prefixSpan.className = 'option-prefix';
                prefixSpan.textContent = prefixes[index] + '.';
                
                const textSpan = document.createElement('span');
                textSpan.textContent = option;
                
                button.appendChild(prefixSpan);
                button.appendChild(textSpan);
                
                button.addEventListener('click', () => {
                    if (canSelectAnswer && !correctAnswerSelected) {
                        checkAnswer(option, currentBhajan.title, currentBhajan.vocal);
                    }
                });
                optionsContainer.appendChild(button);
            });
        }

        // Check if selected answer is correct
        function checkAnswer(selectedOption, correctAnswer, vocalUrl) {
            if (gameOver || !canSelectAnswer || correctAnswerSelected) return;
            
            const options = document.querySelectorAll('.option');
            let correctButton;
            
            options.forEach(button => {
                const optionText = button.querySelector('span:not(.option-prefix)').textContent;
                
                if (optionText === correctAnswer) {
                    correctButton = button;
                    if (selectedOption === correctAnswer) {
                        button.classList.add('correct');
                        correctAnswerSelected = true;
                        // Play vocal version if correct
                        playVocalVersion(vocalUrl);
                        // Show confetti
                        triggerConfetti();
                    }
                } else if (optionText === selectedOption && selectedOption !== correctAnswer) {
                    button.classList.add('wrong');
                }
            });
            
            // Only reveal correct answer if it was selected
            if (selectedOption !== correctAnswer && correctButton) {
                // Don't reveal correct answer yet
                // User needs to select the correct answer to see it
            }
        }

        // Play vocal version of the bhajan
        function playVocalVersion(vocalUrl) {
            if (vocalAudio) {
                vocalAudio.pause();
                vocalAudio.currentTime = 0;
            }
            
            vocalAudio = new Audio(vocalUrl);
            vocalAudio.play();
            
            vocalAudio.addEventListener('ended', () => {
                // When vocal ends, enable next round after a delay
                setTimeout(() => {
                    currentRound++;
                    updateRoundCounter();
                    loadNewBhajan();
                }, 2000); // 2 second delay after vocal ends
            });
        }

        // Trigger confetti effect
        function triggerConfetti() {
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        // Update progress bar
        function updateProgress() {
            if (audio) {
                const progressPercent = (audio.currentTime / audio.duration) * 100;
                progress.style.width = `${progressPercent}%`;
            }
        }

        // End the game (not really used since we have unlimited rounds now)
        function endGame() {
            gameOver = true;
            gameScreen.style.display = 'none';
            gameOverScreen.style.display = 'block';
            
            if (audio) {
                audio.pause();
                audio.currentTime = 0;
            }
            if (vocalAudio) {
                vocalAudio.pause();
                vocalAudio.currentTime = 0;
            }
        }

        // Event listeners
        playBtn.addEventListener('click', () => {
            if (!audio) return;
            
            if (isPlaying) {
                audio.pause();
                isPlaying = false;
                playBtn.textContent = '▶';
            } else {
                audio.play();
                isPlaying = true;
                playBtn.textContent = '❚❚';
            }
        });

        prevBtn.addEventListener('click', () => {
            if (!audio) return;
            audio.currentTime = 0;
            if (!isPlaying) {
                audio.play();
                isPlaying = true;
                playBtn.textContent = '❚❚';
            }
        });

        nextBtn.addEventListener('click', loadNewBhajan);

        nextRoundBtn.addEventListener('click', () => {
            currentRound++;
            updateRoundCounter();
            loadNewBhajan();
        });

        restartBtn.addEventListener('click', initGame);

        // Start with the intro
        showIntro();
    </script>
</body>
</html>
